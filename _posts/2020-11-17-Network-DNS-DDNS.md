---
layout: post
Title:  "[Network] DNS&DDNS"
---
## DNS란 무엇인가?
```cpp
DNS라하면 인터넷망통신규약인 TCP/IP 네트워크상에서 사람이 기억하기 쉽게 문자로 만들어진 도메인을 컴퓨터가 처리할 수 있는 숫자로 된 인터넷주소(IP)로 바꾸는시스템인 Domain Name System을 일컫기도 하고, 이런역할을 하는 서버컴퓨터 즉 Domain Name Server를 일컫기도 합니다.

"도메인이름은 인터넷 주소로서 사람들이 기억하기 쉽고 의미있게붙인 이름이지만, 인터넷에서어떤 컴퓨터를 실제로 찾기 위해서는 숫자 체계로 된 IP주소가 필요하다." 라고 인터넷에서 찾아 볼 수 있습니다. 쉽게는 www.naver.com 도메인이 가지고 있는 IP는 125.209.222.141이 됨을 확인할 수 있다. 즉 수많은 IP로 이루어진 도메인에 대한 이름풀이를 대신해 주는 것이 DNS의 역할 입니다.
```
- - -

## DNS의 작동 원리
```cpp
이름과 숫자를 연결하는 DNS는 인터넷의 어느 한 곳에 위치하지 않습니다. 인터넷 자체와 마찬가지로 이 디렉터리는 전 세계적으로 분산되어 정기적으로 상호 통신해 업데이트와 중복성을 제공하는 도메인 이름 서버에 저장됩니다.

각 명명된 사이트는 하나 이상의 IP 주소에 대응하고 하나의 도메인 이름에 대응하는 IP 주소가 수백 개 이상인 사이트도 있습니다. 예를 들어 자신의 컴퓨터에서 www.google.com에 접속할 때 연결되는 서버는 다른 나라의 다른 사람이 자신의 브라우저에 똑같은 사이트 이름을 입력해 연결하는 서버와는 전혀 다른 서버일 가능성이 높습니다.

이 디렉터리가 분산될 수밖에 없는 또 다른 이유는 디렉터리가 하나의 위치에 있고 동시에 정보를 검색하는 수백만, 아마도 수십억 명의 사용자가 이를 공유할 경우 응답 시간이 매우 길어질 수밖에 없다는 점입니다.

DNS 정보는 다수의 서버에 저장되지만 클라이언트 컴퓨터의 로컬에 캐시로 저장됩니다. 일반적으로 사람들은 google.com을 하루에도 여러 번 사용하는데 사용자 컴퓨터에 이 정보를 저장하면 매번 컴퓨터가 DNS 이름 서버에 google.com의 IP 주소를 질의할 필요가 없으므로 IP 주소로 이름을 확인하기 위해 DNS 서버에 접속할 필요도 없습니다. 클라이언트를 인터넷에 연결하는 데 사용되는 라우터, 사용자 인터넷 서비스 제공업체(ISP)의 서버에서도 캐시가 사용됩니다. 캐시가 워낙 많이 사용되는 덕분에 실제로 DNS 이름 서버에 도달하는 질의의 수는 생각보다 훨씬 적습니다.
```
- - -

## DNS 질의 방법
- - -
### 반복적 질의
```cpp
1) 로컬 DNS에게 요청-> 로컬은 해당 정보를 가지고 있지 않다면 루트 DNS 서버에게 요청하는 IP를 알고 있는지 확인
2) 루트 DNS가 가진 정보가 없을 경우 최상위 DNS 서버(TLD)으로 질의요청하라고 로컬 DNS에게 알림
3) 로컬 DNS는 다시 최상위 DNS 서버에게 질의요청-> 최상위 DNS 서버가 가진 정보가 없을 경우 책임 DNS 서버로 질의요청하라고 로컬 DNS에게 알림
4) 로컬 DNS는 책임 DNS 서버에게 질의요청 -> 책임 DNS는 가지고 있는 해당 IP 주소를 응답
5) 로컬 DNS는 받아온 정보를 사용자에게 최종적으로 알려주고 자신의 DNS 레코드에 나중에 똑같은 요청에 대한 신속한 처리를 위해 저장함
```
- - -
### 재귀적 질의
```cpp
1) 로컬 DNS에게 요청 -> 로컬은 해당 정보를 가지고 있지 않다면 루트 DNS 서버에게 요청하는 IP 질의 요청
2) 루트 DNS 서버에 없을 경우 최상위 DNS 서버에게 질의요청
3) 최상위 DNS 서버에 없을 경우 책임 DNS 서버에게 질의 요청
4) 책임 DNS 서버는 최상위 DNS에게 가지고 있는 IP 정보 응답
5) 최상위 DNS는 받은 정보를 다시 루트 DNS에게 전달
6) 루트 DNS는 로컬 DNS에게 받은 정보를 전달
7) 로컬 DNS는 최종적으로 사용자에게 받은 정보를 전달하고 자신의 DNS 레코드에 해당 정보를 추가함
```
- - -

## DDNS란 무엇인가?
```cpp
가장 일반적으로 동적 DNS로 알려진 DDNS는 이름 서버를 새로 고치는 자동 방법입니다. 사람의 개입없이 DNS 레코드를 동적으로 업데이트 할 수 있습니다. 호스트가 IP 주소를 변경했을 때 A 및 AAAA 레코드를 업데이트하는 데 매우 유용합니다.

예를 들어 사무실에 서버가 있고 직원에게 서비스를 제공하고 있습니다. 일반적인 ISP (인터넷 서비스 제공 업체)의 표준 / 소비자 등급 인터넷을 사용하고 있습니다. 다음 연결 유형을 변경하거나 잠시 후 자동으로 변경할 수있는 임시 IP 주소를 받게됩니다. 서비스를 제공하기 위해 다음과 같은 3 가지 옵션이 있습니다.

1. 비용이 많이들 수있는 고정 IP 주소.
2. IP 주소가 변경 될 때마다 수동으로 변경하십시오.
3. IP 주소 자동 업데이트 – 동적 DNS 또는 DDNS

DDNS는 IP 주소가 변경 될 때 DNS의 A (IPv4) 또는 AAAA (IPv6) 레코드를 자동으로 주기적으로 업데이트하는 서비스입니다. 이러한 IP 변경은 인터넷 제공 업체에서 수행합니다.
DDNS를 사용하면 IP 주소 변경에 대해 걱정할 필요가 없습니다
```
- - -


## DDNS의 작동원리?
```cpp
동적 DNS 서비스 는 소규모 회사와 개인이 인터넷에 서비스를 게시하려고 할 때 사용하며 해당 서비스는 내부 또는 홈 네트워크 내에서 호스팅됩니다.
홈 네트워크는 일반적으로 NAT 라우터 를 사용하여 인터넷에 연결합니다. 즉, 내부 네트워크에있는 장치는 인터넷에서 액세스 할 수 없습니다.

예를 들어 인터넷에서 사용할 수 있는 내부 서버에 웹 서버를 만들고 싶다고 가정합니다.
내부 IP 주소는 DHCP같은 NAT 라우터를 통해 내부 서버에 할당됩니다. 하지만 일반적으로 이러한 상황에서 우리는 정적 내부 IP 주소를 줍니다.
인터넷에서 웹 서비스를 사용할 수 있도록 하기 위해 포트 포워딩을 사용합니다.
이제 웹 서버가 외부 클라이언트에 IPex 및 Portex 포트 에있는 것처럼 보입니다.
여기에 일반적인 숫자를 입력하면 웹 서버는 "IP 주소 = 81.157.34.43 및 포트 80"이 될겁니다.

이제 우리가 해야 할 일은 외부 클라이언트에게 이 값을 사용하도록 지시하는 것입니다.
하지만 외부 IP 주소 IPex(81.157.34.43 )도 ISP 에 의해 동적으로 할당 될 수 있으며 고정 주소에 대한 비용을 지불 하지 않는 한 고정적 으로 만들 수 없습니다. 또한 외부 클라이언트는 IP 주소도 기억해야합니다.

여기서 DDNS를 사용하면 웹 서버에 이름을 할당한 다음 외부 클라이언트에 지정할 수 있고 이름에 외부 IP 주소를 할당합니다.
이제 외부 IP 주소가 주기적으로 변경되므로 DNS 레코드를 주기적으로 업데이트 해야합니다.
물론 이 작업을 수동으로 수행할 수는 있지만 신뢰하기 어렵습니다.
대신 DNS 서버 레코드를 자동으로 업데이트하는 기능은 대부분의 NAT 라우터에 내장되어 있습니다.

```
- - -