---
layout: post
Title:  "[Network] Tunneling"
---
## 터널링이란?
```cpp
데이터 스트림을 인터넷 상에서 가상의 파이프를 통해 전달시키는 기술입니다.
컴퓨터 네트워크에서 터널링 프로토콜을 사용하면 네트워크 사용자는 기본 네트워크가 직접 제공하지 않는 네트워크 서비스에 접근하거나 제공할 수 있습니다. 대표적인 터널링 서비스로는 ngrok, localtunnel등이 있습니다.
```
- - -

## 터널링의 특징
```cpp
1. 호스트와 호스트 사이에 통신이 어떤 프로토콜을 사용하던 간에 일단 터널이 구성되면, 그 안에 원래 패킷은 캡슐화 때문에 패킷이 무엇인지는 중요하지 않게 됩니다.
2. 특정 프로토콜을 지원하지 않는 네트워크를 통해 외부 프로토콜을 실행 할 수 있습니다.
3. 기본 네트워크 서비스만을 사용하여 제공하기에는 비실용적이거나 안전하지 않은 서비스를 제공할 수 있습니다. 예를 들면 실제 네트워크 주소가 회사 네트워크의 일부가 아닌 원격 사용자에게 회사 네트워크 주소를 제공 할 수 있습니다.
4. 터널링은 트래픽 데이터를 다른 형태로 재패키징하기 때문에, 터널을 통해 실행되는 트래픽의 성격이 숨겨집니다.
```
- - -

## 터널링과 캡슐화의 차이
```cpp
캡슐화는 OSI 7 계층을 참조하여 통신을 하기 위해 하위계층에서 상위계층 데이터를 포장하는 개념이고 터널링은 계층이 동일하거나 하위의 다른 프로토콜을 숨기기 위해 상위에서 데이터를 캡슐화하고, 외부 네트워크를 통과하여 목적지에 도착한뒤 다시 디슐화까지 하는 통신과정을 일컫는 말입니다.
```
- - -

## 터널링의 구성 요소
```cpp
승객 프로토콜(Passenger Protocol):
캡슐화가 되어야 할 프로토콜(애플토크, CLNS, IP, IPX)

전달 프로토콜(Carrier Protocol):
캡슐화 시킬 프로토콜(GRE, IP-in-IP, L2TP, MPLS, STUN, DLSw+)

전송 프로토콜(Transport Protocol):
전달 프로토콜을 끌고 갈 프로토콜(IP)

즉, 내부 네트워크에서만 사용되는 승객 프로토콜을 전달 프로토콜의 데이터 안에 집어 넣은 뒤 전송 프로토콜을 통해 목적지로 이동시키는 것입니다. 목적지에 도착하면 출발지에서 하였던 캡슐화를 거꾸로 하여 전달 프로토콜 안에 들어있던 승객 프로토콜을 동작시켜 원하는 목적지로 이동합니다.
```
- - -

## What is ngrok?
```cpp
ngrok은 개발자가 최소한의 노력으로 로컬 개발 서버를 인터넷에 노출 할 수 있도록하는 크로스 플랫폼 애플리케이션입니다. 이 소프트웨어는 로컬에서 호스팅되는 웹 서버가 ngrok.com의 하위 도메인에서 호스팅되는 것처럼 보이게합니다. 즉, 로컬 시스템에 공용 IP 또는 도메인 이름이 필요하지 않습니다. Reverse SSH Tunneling을 사용하여 유사한 기능을 얻을 수 있지만 이를 위해서는 더 많은 설정과 자체 원격 서버 호스팅이 필요합니다.

ngrok는 ngrok.com에서 임의로 생성 된 하위 도메인 (예 : 3gf892ks.ngrok.com)에서 로컬 시스템으로 장기 TCP 터널을 생성하여 NAT 매핑 및 방화벽 제한을 우회 할 수 있습니다. 웹 서버가 수신하는 포트를 지정한 후 ngrok 클라이언트 프로그램이 ngrok 서버에 대한 보안 연결을 시작하면 누구나 고유 한 ngrok 터널 주소를 사용하여 로컬 서버에 요청할 수 있습니다.

기본적으로 ngrok는 HTTP 및 HTTPS 엔드 포인트를 모두 생성하므로 유효한 SSL / TLS 도메인이 필요한 타사 서비스 또는 API와의 통합을 테스트하는 데 유용합니다. 기타 사용 사례로는 클라이언트에게 로컬 데모를 신속하게 보여주고, 모바일 애플리케이션 백엔드를 테스트하고, 가정용 PC에서 개인 클라우드 서비스를 실행합니다. 또한 ngrok 서버 소프트웨어를 VPS 또는 전용 서버에서 자체 호스팅 할 수 있습니다.
```
- - -
